require "test_helper"

class <%= class_name %>UserTest < ActiveSupport::TestCase
  test "should create user with valid attributes" do
    user = <%= class_name %>User.new(
      email_address: "test@example.com",
      password: "password123",
      password_confirmation: "password123"
    )
    assert user.valid?
  end

  test "should require email_address" do
    user = <%= class_name %>User.new(password: "password123")
    assert_not user.valid?
    assert_includes user.errors[:email_address], "can't be blank"
  end

  test "should require unique email_address" do
    <%= class_name %>User.create!(
      email_address: "test@example.com",
      password: "password123"
    )
    
    user = <%= class_name %>User.new(
      email_address: "test@example.com",
      password: "password123"
    )
    assert_not user.valid?
  end

  test "should normalize email_address" do
    user = <%= class_name %>User.create!(
      email_address: " TEST@EXAMPLE.COM ",
      password: "password123"
    )
    assert_equal "test@example.com", user.email_address
  end

  test "should authenticate user" do
    user = <%= class_name %>User.create!(
      email_address: "test@example.com",
      password: "password123"
    )
    
    authenticated = <%= class_name %>User.authenticate_by(
      email_address: "test@example.com",
      password: "password123"
    )
    
    assert_equal user.id, authenticated.id
  end
end
